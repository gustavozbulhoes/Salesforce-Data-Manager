<template>
	<!-- Spinner -->
	<template lwc:if={showSpinner}>
		<lightning-spinner alternative-text="Loading" size="medium" class="spinnerClass"></lightning-spinner>
	</template>
	
	<lightning-card title="Bulk Manage Records By Pasting Data from Excel">

		<template lwc:if={data}>
			<div class="slds-grid slds-wrap">
				<div class="slds-col slds-large-size_2-of-12 slds-medium-size_3-of-12 slds-size_4-of-12 slds-var-p-around_xx-small">
					<lightning-combobox name="Object" label="Object" value={objectName} placeholder="Select Object" options={objects} onchange={handleObjectChange} disabled={finished}></lightning-combobox>
				</div>
				<div class="slds-col slds-large-size_2-of-12 slds-medium-size_3-of-12 slds-size_4-of-12 slds-var-p-around_xx-small">
					<lightning-combobox name="OperationType" label="Operation" value={operationType} placeholder="Select Operation Type" options={operations} onchange={handleOperationChange} disabled={finished} ></lightning-combobox>
				</div>
				<div class="slds-col slds-large-size_1-of-12 slds-medium-size_2-of-12 slds-size_3-of-12 slds-var-p-around_xx-small">
					<lightning-input disabled={finished} type="number" label="Cunk Size" name="chunkSize" max="200" min="1" formatter="number" step="1" value={chunkSize} required field-level-help="Define the number of records that will be processed in each batch when handling large datasets. This is particularly useful to avoid hitting limits or timeouts when working with a large number of records in Salesforce."  onchange={changeChunkSizeHandler}></lightning-input>
				</div>
				<div class="slds-col slds-large-size_1-of-12 slds-medium-size_2-of-12 slds-size_2-of-12 slds-var-p-around_xx-small slds-var-m-top_large">
					<lightning-button label="Process" disabled={disableProcessRecords} onclick={handleProcessRecords} variant="brand"></lightning-button>
				</div>
				<template lwc:if={finished}>
					<div class="slds-col slds-large-size_1-of-12 slds-medium-size_1.5-of-12 slds-size_2-of-12 slds-var-p-around_xx-small slds-var-m-top_large">
						<lightning-button label="Refresh" icon-name="utility:refresh" onclick={refresh} class="slds-var-m-left_x-small"></lightning-button>
					</div>
				</template>
			</div>
		</template>

		<template lwc:else>
			<p class="slds-m-around_large">
				<lightning-icon icon-name='utility:paste' alternative-text='paste' variant='error' size='medium' title='paste'></lightning-icon><b>PASTE DATA</b></p>
			</p>
		</template>
		<template lwc:if={finished}>
			<div class="slds-col slds-large-size_1-of-12 slds-medium-size_1.5-of-12 slds-size_2-of-12 slds-var-p-around_x-small">
				<lightning-button label="Copy Result" icon-name="utility:copy" onclick={copyToClipboard}></lightning-button>
			</div>
		</template>		
		<lightning-datatable hide-checkbox-column="true" data={data} columns={columns} key-field="value"></lightning-datatable>
    </lightning-card>
</template>